[query]
categories_query="SELECT category_id, category_title, category_desc, COUNT(p_id) category_products FROM (SELECT p.id p_id, c.id category_id, c.title category_title, c.description category_desc FROM products p JOIN category_product cp ON cp.product_id = p.id AND p.active = 1 JOIN categories c ON cp.category_id = c.id UNION SELECT p.id p_id, c.id category_id, c.title category_title, c.description category_desc FROM products p JOIN categories c ON p.main_category_id = c.id AND p.active = 1) as T GROUP BY category_id ORDER BY category_products DESC;"
category_products="SELECT p.id product_id, p.title product_title, c.id main_category_id, c.title main_category_title, i.url image_url, i.alt image_alt FROM products p JOIN categories c ON p.main_category_id = c.id AND p.active = 1 JOIN category_product cp ON p.id = cp.product_id AND cp.category_id = ? JOIN images i ON p.main_image_id = i.id UNION SELECT p.id product_id, p.title product_title, c.id main_category_id, c.title main_category_title, i.url image_url, i.alt image_alt FROM products p JOIN categories c ON p.main_category_id = c.id AND p.active = 1 AND p.main_category_id = ? JOIN images i ON p.main_image_id = i.id LIMIT ? OFFSET ?;"
n_category_products="SELECT product_id, p.title product_title, p.main_category_id main_category_id, c.title main_category_title, url image_url, alt image_alt, c1.id current_category_id, c1.title current_category_title, c1.description current_category_description FROM ( SELECT cp.category_id, cp.product_id FROM category_product cp JOIN products p ON cp.product_id = p.id AND p.active = 1 AND cp.category_id = ? UNION SELECT c.id category_id, p.id product_id FROM categories c JOIN products p ON c.id = p.main_category_id AND p.active = 1 AND c.id = ?) AS T JOIN products p ON product_id = p.id JOIN categories c ON c.id = p.main_category_id JOIN images i ON i.id = p.main_image_id JOIN categories c1 ON c1.id = category_id LIMIT ? OFFSET ?;"
product_main_info="SELECT p.id product_id, p.title product_title, p.price, p.price_discount, p.price_promo, p.description, i.url main_image_url, i.alt main_image_alt, c.id main_category_id, c.title main_category_title FROM products p JOIN images i ON p.main_image_id = i.id AND p.id = :product_id JOIN categories c ON p.main_category_id = c.id;"
product_images="SELECT i.url, i.alt FROM images i JOIN product_image pi ON i.id = pi.image_id JOIN products p ON pi.product_id = p.id AND p.id = :product_id;"
product_categories="SELECT c.id, c.title, c.description FROM categories c JOIN category_product cp ON c.id = cp.category_id JOIN products p ON cp.product_id = p.id AND p.id = :product_id;"
